
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SmartSender</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; }
    input, textarea, button { width: 100%; margin-top: 10px; padding: 10px; }
    #statusMessage { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>

  <h2>📬 SmartSender Gmail 邮件群发系统</h2>

  <label for="gmailUser">Gmail 地址：</label>
  <input type="email" id="gmailUser" placeholder="例如：yourname@gmail.com" />

  <label for="appPassword">Gmail 应用密码：</label>
  <input type="password" id="appPassword" placeholder="16位应用密码" />

  <label for="bccEmail">📥 测试收件人邮箱地址（Bcc）：</label>
  <input type="email" id="bccEmail" placeholder="例如：cshiy98@gmail.com" />

  <label for="subject">邮件主题：</label>
  <input type="text" id="subject" placeholder="请输入邮件标题" />

  <label for="body">邮件内容（支持 HTML）：</label>
  <textarea id="body" rows="8" placeholder="例如：<h1>Hello!</h1><p>This is a test.</p>"></textarea>

  <button onclick="sendEmail()">✉️ 发送测试邮件</button>

  <div id="statusMessage"></div>

  <script>
    async function sendEmail() {
      const user = document.getElementById('gmailUser').value.trim();
      const pass = document.getElementById('appPassword').value.trim();
      const bcc = document.getElementById('bccEmail').value.trim();
      const subject = document.getElementById('subject').value.trim();
      const body = document.getElementById('body').value;

      const statusEl = document.getElementById('statusMessage');
      statusEl.innerText = "⏳ 正在发送中，请稍候...";

      if (!user || !pass || !bcc || !subject || !body) {
        statusEl.innerText = "⚠️ 请填写所有字段后再尝试发送！";
        return;
      }

      try {
        const response = await fetch("https://smart-sender-api.vercel.app/send", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ user, pass, bcc, subject, body })
        });

        const result = await response.json();

        if (result.success) {
          statusEl.innerText = "✅ 邮件已成功发送！（请查收 Inbox 或 Spam）";
        } else {
          statusEl.innerText = "❌ 邮件发送失败：" + (result.message || "请检查应用密码是否正确");
        }
      } catch (error) {
        statusEl.innerText = "❌ 网络错误或服务异常，请稍后重试";
      }
    }
  </script>
</body>
</html>
